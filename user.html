<!DOCTYPE html>
<html lang="en">
<head>
<title>个人中心</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="baidu-site-verification" content="z8EeuYl0nS" />
<meta name="keywords" content="华路卓">
<meta name="description" content="华路卓">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
<link href="css/basic.css" rel="stylesheet"/>
<script src="js/rem.js"></script>
<script type="text/javascript"  src="js/jquery-2.1.4.min.js"></script>
<script src="js/browser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="js/base.js" type="application/javascript"></script>
<script src="http://res2.wx.qq.com/open/js/jweixin-1.4.0.js" type="application/javascript"></script>
</head>
<body>
<style>
.w750{
    color:#666;
    width:100%;
    min-height:100%;
    background: #f2f2f2;
}
.p40{
    height: 100%;
}
.user_left{
  display: block;
}
.user_sort{
    height:.98rem;
    display:flex;
    align-items:center;
    width:100%;
    background:#fff;
}
.user_item{
    height:.79rem;
    width:33.33%;
    text-align:center;
}
.item_top{
  width:100%;
    height:50%;
    color:#000;
}
.user_item a{
  width:100%;
  height:100%;
}
.item_bottom{
    height:50%;
}
.vertical_line{
    width:2%;
    height:70%;
}
</style>
<div id="app">
  <div class="w750">
      <div class="banner">
    <div class="p40">
        <div class="banner_top">
          <a href="userMessage.html"><img src="images/tixing.png"/></a>
        </div>
        <div class="banner_bottom flexRowBetween">
          <div class="user_left">
            <div style="font-size:.38rem;color:#fff;height: 60%;display: flex;align-items: center;">
              {{mainData.nickname}}
            </div>
            <div class="resume font34" style="height:40%;display: flex;align-items: center;">
              <a href="userResume.html">个人简历 >> </a>
            </div>
 
          </div>
          <div class="user_right">
              <div class="user_img">
                <img class="user_img" :src="mainData.headImgUrl" />
              </div>
          </div>
        </div>
    </div>
  </div>
  <div class="user_sort">
    <div class="user_item flexRowBetween">
      <a style="width:98%;" href="userCash.html">
       <div class="item_top font32">{{computeData?computeData:''}}.00</div>
       <div class="item_bottom font34">已提现(元)</div>
      </a>
      <div class="vertical_line">
        <div style="width:1px;height:100%;border-left:dashed 1px #ed7101;"></div>
      </div>
    </div>
    <div class="user_item flexRowBetween">
      <div style="width:98%;">
       <div cldss="item_top font32">{{mainData.info?mainData.info.balance:''}}</div>
       <div class="item_bottom font34">我的余额(元)</div>
      </div>
      <div class="vertical_line">
        <div style="width:1px;height:100%;border-left:dashed 1px #ed7101;"></div>
      </div>
    </div>
    <div class="user_item">
      <a href="userNext.html">
       <div class="item_top font32">{{num}}</div>
       <div class="item_bottom font34">我的下级</div>
      </a>
    </div>
  </div>
  <div class="user flexRowBetween font32">
    <a class="user_module" href="userInfor.html">
        <div class="module_img">
          <img src="images/user_icon1.png"/>
        </div>
        <div class="module_text">个人信息</div>
    </a>
    <div class="user_module"  href="userCash.html">
      <a  style="height:100%;border-left:solid 1px #e0e0e0;border-right:solid 1px #e0e0e0;">
        <div class="module_img">
          <img src="images/user_icon2.png"/>
        </div>
        <div class="module_text">账户信息</div>
      </a>
    </div>
    <a class="user_module" href="userCollect.html">
        <div class="module_img">
          <img src="images/user_icon3.png"/>
        </div>
        <div class="module_text">我的收藏</div>
    </a>
    <a class="user_module" href="userNext.html">
        <div class="module_img">
          <img src="images/user_icon4.png"/>
        </div>
        <div class="module_text">我的下级</div>
    </a>
    <div class="user_module">
      <a  style="height:100%;border-left:solid 1px #e0e0e0;border-right:solid 1px #e0e0e0;" href="userWageQuery.html">
        <div class="module_img">
          <img src="images/user_icon5.png"/>
        </div>
        <div class="module_text">工资查询</div>
      </a>
    </div>
    <a class="user_module" href="merchant.html">
        <div class="module_img">
          <img src="images/user_icon6.png"/>
        </div>
        <div class="module_text">商家入口</div>
    </a>
    <a class="user_module" href="userPhoneCard.html">
        <div class="module_img">
          <img src="images/user_icon7.png"/>
        </div>
        <div class="module_text" style="width:80%;margin:0 auto">免费领取中国电信移动卡</div>
    </a>
    <div class="user_module">
      <a  style="height:100%;border-left:solid 1px #e0e0e0;border-right:solid 1px #e0e0e0;" href="userMakeMoney.html">
        <div class="module_img">
          <img src="images/user_icon8.png"/>
        </div>
        <div class="module_text">转发赚钱</div>
      </a>
    </div>
    <a class="user_module" href="userInterview.html">
        <div class="module_img">
          <img src="images/user_icon9.png"/>
        </div>
        <div class="module_text">面试通知</div>
    </a>
  </div>
  <div style="height:0.98rem;width:100%;"></div>
  <div class="navbar">
        <a class="navbar_item" href="index.html">
            <div class="nav_img">
              <img src="images/navbar1.png">
            </div>
            <div class="text">找工作</div>
        </a>
        <a class="navbar_item" href="user.html">
            <div class="nav_img">
               <img src="images/navbar2-a.png">
            </div>
            <div class="text this-text">个人中心</div>
        </a>
        <a class="navbar_item" href="about.html">
            <div class="nav_img">
                <img src="images/navbar3.png">
            </div>
            <div class="text">了解我们</div>
        </a>
    </div>
  </div>
</div>
<script type="text/javascript">
            
    var app = new Vue({
        el: '#app',
        data: function() {
            return {
              distriData:[],
              mainData:[],
              computeData:[],
              paginate: {
                count: 0,
                currentPage: 1,
                pagesize: 6,
                is_page: true,
              },

              searchItem:{
                  
              },
              pageArray:[],
              allPages:0,
              linkPage:'',
              num:''
            }

        },
        
        created: function () {
            var callback = (res)=>{
              this.getComputeData();
              this.userGet();
              this.wxJsSdk();
              this.getDistri()
            };
            window.base.getUserToken(callback);
        },

        methods:{

            share(){
              console.log(123)
              wx.showAllNonBaseMenuItem();
            },

            wxJsSdk(){
                const self = this;
                const postData = {
                    thirdapp_id:2,
                    url:window.location.href
                };
                const callback = (res)=>{
                    console.log(res)
                    wx.config({
                      debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                      appId:res.appId, // 必填，公众号的唯一标识
                      timestamp:res.timestamp , // 必填，生成签名的时间戳
                      nonceStr:res.nonceStr, // 必填，生成签名的随机串
                      signature:res.signature,// 必填，签名
                      jsApiList: ['onMenuShareAppMessage','showAllNonBaseMenuItem'] // 必填，需要使用的JS接口列表
                  });


                  wx.ready(function () {   //需在用户可能点击分享按钮前就先调用
                      wx.onMenuShareAppMessage({ 
                          title: 'test', // 分享标题
                          desc: 'test', // 分享描述
                          link: 'http://solelytech.iicp.net/hlzweb/user.html', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
                          imgUrl: 'http://solelytech.iicp.net/hlzweb/images/user_icon1.png', // 分享图标
                      }, function(res) { 
                          console.log('error',res)
                      });  
                  });


                  wx.error(function(res){
                    console.log('error',res)
                  });
                };
                window.base.WxJssdk(postData,callback);
            },

            userGet(){
                const self = this;
                const postData = {
                    token:localStorage.getItem('user_token'),
                    thirdapp_id:2
                };
                const callback = (res)=>{
                    if(res.info.data.length>0){
                        self.mainData = res.info.data[0]
                    }else{
                        alert('数据错误')
                    }
                    console.log(self.mainData)
                }
                window.base.userGet(postData,callback);
            },  

            getComputeData(){
              const self = this;
              const postData = {};
              postData.data = {
                FlowLog:{
                  compute:{
                    count:'sum',
                  },
                  
                  searchItem:{
                    user_no:self.mainData.user_no,
                    type:2,
                    count:['<',0],
                    status:['in',[0,1]]
                  }
                }
              };
              const callback = (res)=>{
                
                  self.computeData = -res.info.FlowLog.countsum;
              
                console.log(self.computeData)
              };
              window.base.flowLogCompute(postData,callback);
            },

            getDistri(){
                const self = this;
                console.log(666)
                var postData = {};
                postData.token = localStorage.getItem('user_token'),
                postData.searchItem = {
                    parent_no:localStorage.getItem('user_no')
                };
               
                const callback = (res)=>{
                    console.log(res)
                    if(res.info.data.length>0){
                    	self.distriData.push.apply(self.distriData,res.info.data);
                    	self.num = self.distriData.length;
                    	console.log(self.distriData.length)
                    }
                    	
                }
                window.base.distriGet(postData,callback); 
                
            },  

             intoDetail(e) {
                var self = this;
                var art_id = window.base.getDataSet(e).id;
                window.location.href = "./indexDetail.html?id=" + art_id;
            },   

           
        }
    });            
</script>
</body>
</html>